This is a PyTorch version GPU-Match&Locate modified from [GPU-Match&Locate1.0](https://github.com/MinLiu19/GPU-MatchLocate1.0).\
Features of this version:
1. Not only the detection results but also the configurations of your every experiment are logged
2. Automatically checking operational stations for each `candidate`-`template` pair. This is useful for temporary seismic network in which some stations might be unused for a period.
3. Allowing you to continue your last experiment terminated by accidental error (e.g., memory limit). You do NOT need to run the whole program from scratch.
0. Using 1-D convolutional layer rather than CUDA-kernel to calculate cross-correlation

To run this program, two kinds of data are required.
1. Continuous waveform (we often call it as `candidate`) preprocessed by [LOC-FLOW](https://github.com/Dal-mzhang/LOC-FLOW/blob/main/Data/waveform_download_mseed.py)
2. Catlog of relocated earthquakes generated by [GrowClust](https://github.com/dttrugman/GrowClust/blob/master/EXAMPLE/OUT/out.growclust_cat)

Some [`default configugrations`](./config.yml) of this program are set by [`create_config.py`](./create_config.py). Becauset of too many configurations, an easier way to set/change configurations is as follows:
```
python GPU_MATCH_LOCATE.py --cuda=1 --mad_threshold=10 --halfwin_for_local_mad=5 --local_mad_threshold=10 --snr_threshold=1 --minimum_cc=.3 --number_high_cc_channels=5 --number_stations_threshold=4 --plot=1 --too_close_detections_to_remain=6 --max_number_stations_threshold=80
```
Once you run the command above, two folders will be created: `template` and `experiments`.
1. The `template` folder saves the template waveform in the format of hdf5 and the images of the waveform if `--plot=1`
2. The `experiments` folder logs the results and the configurations of every experiment. Its subfolders ared named in the format of `YYYYMMDDTHHMMSS` (i.e., the local time when you run the command). In each subfolder, two sub-subfolders exist: `catalog` and `pdf` save the detections and images, respectively

If this is not your first time to run the code, I suggest you cancel the process of marking templates by commenting the 236th line in [`GPU_MATCH_LOCATE.py`](./GPU_MATCH_LOCATE.py).

Prerequisite:
* Nvidia-GPU
* PyTorch
* Obspy
* h5py

Any suggestions or issues are welcome. Please feel free to contact me via [email](mailto:jun__zhu@outlook.com) or GitHub issues.